<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>HydroMatic ADMIN</title>
    <link rel="icon" href="/img/Logo.png" type="image/x-icon">
    <meta name="author" content="name">
    <meta name="description" content="description here">
    <meta name="keywords" content="keywords,here">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
    <link rel="stylesheet" href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css" />
    <!--Replace with your tailwind.css once created-->
    <link href="https://afeld.github.io/emoji-css/emoji.css" rel="stylesheet"> <!--Totally optional :) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"
        integrity="sha256-xKeoJ50pzbUGkpQxDYHD7o7hxe0LaOGeguUidbq6vis=" crossorigin="anonymous"></script>

</head>
<style>
    .font-family-karla {
        font-family: 'Poppins', sans-serif;
    }

    .bg-body {
        background: #1f272b;
    }

    .text1 {
        color: #15cc15;
    }

    .bg-c {
        background: rgb(224, 224, 224);
    }

    .text2 {
        color: #FFFF;
    }

    .text-combined {
        display: inline-block;
        font-weight: 700;
    }

    section#video-background-section {
        background-color: #000;
        /* Black fallback */
    }

    .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(31, 39, 43, 0.5);
        /* Adjusted opacity for a dimmer effect */
        pointer-events: none;
        /* Prevent the overlay from blocking interactions */
    }

    .text {
        height: 55%;
        position: relative;
        z-index: 10;
        text-align: left;
        max-width: 700px;
        /* Restrict text container width */
        padding-left: 20px;
        /* Add some padding */
        right: 25%;
        /* Make sure text doesn't go too far right on smaller screens */
    }

    .text h2 {
        font-size: 4rem;
        /* Use rem units for better scalability */
        font-weight: 800;
        color: #fff;
        line-height: 1em;
        text-transform: uppercase;
    }

    .text h3 {
        font-size: 3rem;
        /* Adjusted for responsiveness */
        font-weight: 700;
        color: #fff;
        line-height: 1em;
        text-transform: uppercase;
    }

    .text p {
        font-size: 1rem;
        /* Smaller font size for responsiveness */
        color: #fff;
        margin: 20px 0;
        font-weight: 400;
        max-width: 700px;
    }

    /* Media Queries for responsiveness */

    /* For tablets */
    @media (max-width: 1024px) {
        .text h2 {
            font-size: 3rem;
        }

        .text h3 {
            font-size: 2.5rem;
        }

        .text p {
            font-size: 0.95rem;
        }

        .text {
            max-width: 90%;
            /* Increase max-width for tablets */
            right: 10%;
        }
    }

    /* For small devices (mobile) */
    @media (max-width: 768px) {
        .text h2 {
            font-size: 2.5rem;
        }

        .text h3 {
            font-size: 2rem;
        }

        .text p {
            font-size: 0.9rem;
        }

        .text {
            max-width: 100%;
            /* Allow the text to use full width on mobile */
            right: 0;
            padding-left: 15px;
        }
    }

    /* For very small devices (smaller mobile) */
    @media (max-width: 480px) {
        .text h2 {
            font-size: 2rem;
        }

        .text h3 {
            font-size: 1.5rem;
        }

        .text p {
            font-size: 0.85rem;
        }

        .text {
            max-width: 100%;
            right: 0;
            padding-left: 10px;
        }
    }
</style>


<body class="bg-gray-800 font-sans leading-normal tracking-normal mt-12">

    <header>
        <!--Nav-->
        <nav aria-label="menu nav" class="bg-gray-800 pt-2 md:pt-1 pb-1 px-4 mt-0 h-auto fixed w-full z-20 top-0">
            <div class="container mx-auto flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <div class="w-16 h-16">
                        <img src="/img/Logo.png" alt="HydroMatic Logo">
                    </div>
                    <a href="admin-main"
                        class="text-2xl md:text-3xl lg:text-4xl xl:text-5xl uppercase font-family-karla hover:text-green-100 text-combined">
                        <span class="text2">Hydro</span><span class="text1">Matic</span> <span
                            class="text2">ADMIN</span>
                    </a>
                </div>
                <!-- Logout Button Positioned to the Right -->
                <button id="logout-button" class="bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700">
                    Logout
                </button>
            </div>
        </nav>
    </header>



    <main>
        <div class="flex mt-20 px-1 flex-col md:flex-row">
            <nav aria-label="alternative nav">
                <div
                    class="bg-gray-800 h-20 fixed bottom-0 mt-12 md:relative md:h-screen z-10 w-full md:w-48 content-center">
                    <div
                        class="md:mt-12 md:w-48 md:fixed md:left-0 md:top-0 content-center md:content-start text-left justify-between">
                        <ul
                            class="list-reset flex flex-row md:flex-col pt-3 md:py-3 px-1 md:px-2 text-center md:text-left">
                            <li class="mr-3 flex-1">
                                <a href="admin-main"
                                    class="block py-1 md:py-3 pl-1 align-middle text-white no-underline hover:text-white border-b-2 border-gray-800 hover:border-green-500">
                                    <span
                                        class="pb-1 md:pb-0 text-xs md:text-base text-white md:text-white block md:inline-block">Dashboard</span>
                                </a>
                            </li>
                            <li class="mr-3 flex-1">
                                <a href="admin-cms"
                                    class="block py-1 md:py-3 pl-1 align-middle text-white no-underline hover:text-white border-b-2 border-blue-600">
                                    <span
                                        class="pb-1 md:pb-0 text-xs md:text-base text-gray-400 md:text-gray-200 block md:inline-block">CMS</span>
                                </a>
                            </li>
                            <li class="mr-3 flex-1">
                                <a href="admin-user"
                                    class="block py-1 md:py-3 pl-1 align-middle text-white no-underline hover:text-white border-b-2 border-gray-800 hover:border-green-500">
                                    <span
                                        class="pb-1 md:pb-0 text-xs md:text-base text-gray-400 md:text-gray-200 block md:inline-block">Manage
                                        User Account</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <section class="w-full h-full flex">
                <div id="main" class="w-full main-content flex-1 bg-gray-100 mt-12 md:mt-2 pb-24 md:pb-5">
                    <div class="bg-gray-800">
                        <div
                            class="rounded-tl-3xl bg-gradient-to-r from-blue-900 to-gray-800 p-4 shadow text-2xl text-white">
                            <h1 class="font-bold pl-2">Content Management System</h1>
                        </div>
                    </div>
                    <div class="w-full p-6">
                        <div class="bg-white border-transparent rounded-lg shadow-xl">
                            <!-- Video Background Section -->
                            <section id="video-background-section"
                                class="relative w-full h-screen flex items-center justify-center">
                                <!-- Video Background -->
                                <video autoplay muted loop playsinline
                                    class="absolute top-0 left-0 w-full h-full object-cover">
                                    <source src="img\hydrovid.mp4" type="video/mp4">
                                </video>

                                <!-- Dark Overlay -->
                                <div class="overlay"></div>

                                <!-- Text Overlay -->
                                <div class="text">
                                    <h2 id="auto" contenteditable="true"></h2>
                                    <h3 id="Hydro" contenteditable="true"></h3>
                                    <p id="para" contenteditable="true"></p>
                                </div>
                            </section>
                            <!-- Hero Section -->
                            <section id="Hero" class="bg-c pt-16 pb-20 px-10 w-full h-auto">
                                <div class="container mx-auto flex flex-col md:flex-row items-center">
                                    <div id="headings-container" class="space-y-6 text-center md:text-left">
                                        <h1 id="heading" contenteditable="true"
                                            class="text-5xl font-bold text-black leading-tight">
                                        </h1>
                                        <p id="Textheading" contenteditable="true"
                                            class="text-black mx-5 lg:mr-11 text-justify">
                                        </p>
                                    </div>
                                    <div class="zoom-container mx-auto">
                                        <img id="sampleDevice" src="" class="w-auto h-full object-cover" alt="Descriptive Image Text">
                                    </div>
                                </div>
                            </section>
                            <!-- Features Section -->
                            <section id="Features" class="bg-body py-44 ">
                                <div class="container mx-auto text-center p-6 ">
                                    <h2 id="featTitle" contenteditable="true"
                                        class="text-5xl font-bold text-gray-200 mb-8 scroll-animation">
                                        Key Features</h2>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                                        <div class="feature-item p-6 bg-gray-100 rounded-lg shadow-lg">
                                            <div class="text-4xl text-d mb-4"><i class="fas fa-calendar-days"></i></div>
                                            <h3 id="realTime" contenteditable="true"
                                                class="text-2xl font-bold text-gray-800 mb-2 scroll-animation"></h3>
                                            <p id="realTimeText" contenteditable="true"
                                                class="text-lg text-gray-800 mb-2 scroll-animation">
                                            </p>
                                        </div>
                                        <div class="feature-item p-6 bg-gray-100 rounded-lg shadow-lg">
                                            <div class="text-4xl text-d mb-4"><i class="fas fa-bell"></i></div>
                                            <h3 id="sms" contenteditable="true"
                                                class="text-2xl font-bold text-gray-800 mb-2 scroll-animation">
                                            </h3>
                                            <p id="smsText" contenteditable="true"
                                                class="text-lg text-gray-800 mb-2 scroll-animation"></p>
                                        </div>
                                        <div class="feature-item p-6 bg-gray-100 rounded-lg shadow-lg">
                                            <div class="text-4xl text-d mb-4"><i class="fas fa-seedling"></i></div>
                                            <h3 id="IoT" contenteditable="true"
                                                class="text-2xl font-bold text-gray-800 mb-2 scroll-animation">
                                            </h3>
                                            <p id="IoTText" contenteditable="true"
                                                class="text-lg text-gray-800 mb-2 scroll-animation"></p>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            <!-- About HydroMatic -->
                            <section id="aboutHydro" class="bg-c py-8">
                                <div
                                    class="mx-auto grid max-w-2xl grid-cols-1 items-center gap-x-8 gap-y-16 px-4 py-24 sm:px-6 sm:py-32 lg:max-w-7xl lg:grid-cols-2 lg:px-8">
                                    <div>
                                        <h2 id="HydroTitle" contenteditable="true"
                                            class="text-2xl font-bold tracking-tight text-black-200 sm:text-4xl scroll-animation">
                                        </h2>
                                        <p id="HydroText" contenteditable="true"
                                            class="mt-4 text-black-200 scroll-animation text-justify"></p>
                                    </div>
                                    <img id="hydroImg" src="" class="scroll-animation">
                                </div>
                            </section>
                            <!-- Steps to Connect the esp8266 to the WiFi -->
                            <section id="Steps" class="bg-body pt-12 pb-8">
                                <div class="mx-auto max-w-7xl text-center">
                                    <h2 id="stepsTitle" class="text-2xl pb-6 font-bold tracking-tight text-gray-100 sm:text-3xl"></h2>
                                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 justify-items-center items-start scroll-animation">
                            
                                        <!-- Step 1 -->
                                        <div class="flex flex-col items-center bg-gray-700 rounded-lg shadow-lg p-4 w-full max-w-xs ">
                                            <img id="stepsImg1" src="" alt="Step 1 Image" class="object-cover rounded-lg mb-4">
                                            <h3 class="text-lg font-bold text-gray-100 mb-2">Step 1</h3>
                                            <p id="step1" class="text-gray-100 text-sm sm:text-base font-medium mb-2">Set up your HydroMatic hardware.</p>
                                        </div>
                            
                                        <!-- Step 2 -->
                                        <div class="flex flex-col items-center bg-gray-700 rounded-lg shadow-lg p-4 w-full max-w-xs sm:max-w-sm ">
                                            <img id="stepsImg2" src="" alt="Step 2 Image" class="  object-cover rounded-lg mb-4">
                                            <h3 class="text-lg font-bold text-gray-100 mb-2">Step 2</h3>
                                            <p id="step2" class="text-gray-100 text-sm sm:text-base font-medium mb-2">Connect the device to your network.</p>
                                        </div>
                            
                                        <!-- Step 3 -->
                                        <div class="flex flex-col items-center bg-gray-700 rounded-lg shadow-lg p-4 w-full max-w-xs sm:max-w-sm ">
                                            <img id="stepsImg3" src="" alt="Step 3 Image" class=" object-cover rounded-lg mb-4">
                                            <h3 class="text-lg font-bold text-gray-100 mb-2">Step 3</h3>
                                            <p id="step3" class="text-gray-100 text-sm sm:text-base font-medium mb-2">Calibrate the system and test sensors.</p>
                                        </div>
                            
                                        <!-- Step 4 -->
                                        <div class="flex flex-col items-center bg-gray-700 rounded-lg shadow-lg p-4 w-full max-w-xs sm:max-w-sm h-[400px]">
                                            <img id="stepsImg4" src="" alt="Step 4 Image" class=" object-cover rounded-lg mb-4">
                                            <h3 class="text-lg font-bold text-gray-100 mb-2">Step 4</h3>
                                            <p id="step4" class="text-gray-100 text-sm sm:text-base font-medium mb-2">Start automated monitoring and control.</p>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            <!-- About Us Section -->
                            <section id="aboutUs" class="bg-gray-100 py-16 ">
                                <div class="container mx-auto px-4">
                                    <!-- About Us Heading -->
                                    <div class="text-center mb-12">
                                        <h2 id="aboutHead" contenteditable="true"
                                            class="text-5xl font-bold text-gray-800 scroll-animation">
                                        </h2>
                                        <p id="aboutHeadText" contenteditable="true"
                                            class="text-gray-600 mt-4 scroll-animation"></p>
                                    </div>

                                    <!-- Mission Statement -->
                                    <div class="flex flex-col md:flex-row items-center mb-12 scroll-animation">
                                        <!-- Image Section -->
                                        <div class="md:w-1/2 mb-8 md:mb-0 scroll-animation">
                                            <img id="aboutImg" src="" alt="Our Team"
                                                class="w-full h-auto rounded-lg shadow-lg">
                                        </div>
                                        <!-- Text Section -->
                                        <div class="md:w-1/2 md:pl-12">
                                            <h3 id="mission" contenteditable="true"
                                                class="text-3xl font-semibold text-gray-800 scroll-animation"></h3>
                                            <p id="missionText1" contenteditable="true"
                                                class="text-gray-600 mt-4 scroll-animation text-justify"></p>
                                            <p id="missionText2" contenteditable="true"
                                                class="text-gray-600 mt-4 scroll-animation text-justify"></p>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            <!-- FAQ Section -->
                            <section id="faq" class="bg-gray-100 py-16">
                                <div class="container mx-auto px-4">
                                    <div class="text-center mb-12">
                                        <h2 id="faqTitle" contenteditable="true"
                                            class="text-5xl font-bold text-gray-800"></h2>
                                        <p id="faqDesc" contenteditable="true" class="text-gray-600 mt-4"></p>
                                    </div>

                                    <div class="space-y-4">
                                        <!-- FAQ Item 1 -->
                                        <div class="faq-item bg-body p-6 rounded-lg shadow-lg cursor-pointer">
                                            <div class="flex justify-between items-center"
                                                onclick="toggleAnswer('answer1', this)">
                                                <h3 id="faqItem1" contenteditable="true"
                                                    class="text-lg font-semibold text-gray-200"></h3>
                                                <button
                                                    class="bg-gray-500 text-white py-2 px-3 rounded-full flex items-center">
                                                    <span class="arrow-icon"><i
                                                            class="fas fa-chevron-down text-2xl font-bold"></i></span>
                                                    <!-- Downward Arrow -->
                                                </button>
                                            </div>
                                            <div id="answer1" contenteditable="true"
                                                class="hidden mt-2 text-center text-gray-300">
                                            </div>
                                        </div>

                                        <!-- FAQ Item 2 -->
                                        <div class="faq-item bg-body p-6 rounded-lg shadow-lg cursor-pointer">
                                            <div class="flex justify-between items-center"
                                                onclick="toggleAnswer('answer2', this)">
                                                <h3 id="faqItem2" contenteditable="true"
                                                    class="text-lg font-semibold text-gray-200"></h3>
                                                <button
                                                    class="bg-gray-500 text-white py-2 px-3 rounded-full flex items-center">
                                                    <span class="arrow-icon"><i
                                                            class="fas fa-chevron-down text-2xl font-bold"></i></span>
                                                    <!-- Downward Arrow -->
                                                </button>
                                            </div>
                                            <div id="answer2" contenteditable="true"
                                                class="hidden mt-2 text-center text-gray-300">
                                            </div>
                                        </div>

                                        <!-- FAQ Item 3 -->
                                        <div class="faq-item bg-body p-6 rounded-lg shadow-lg cursor-pointer">
                                            <div class="flex justify-between items-center"
                                                onclick="toggleAnswer('answer3', this)">
                                                <h3 id="faqItem3" contenteditable="true"
                                                    class="text-lg font-semibold text-gray-200"></h3>
                                                <button
                                                    class="bg-gray-500 text-white py-2 px-3 rounded-full flex items-center">
                                                    <span class="arrow-icon"><i
                                                            class="fas fa-chevron-down text-2xl font-bold"></i></span>
                                                    <!-- Downward Arrow -->
                                                </button>
                                            </div>
                                            <div id="answer3" contenteditable="true"
                                                class="hidden mt-2 text-center text-gray-300">
                                            </div>
                                        </div>

                                        <!-- FAQ Item 4 -->
                                        <div class="faq-item bg-body p-6 rounded-lg shadow-lg cursor-pointer">
                                            <div class="flex justify-between items-center"
                                                onclick="toggleAnswer('answer4', this)">
                                                <h3 id="faqItem4" contenteditable="true"
                                                    class="text-lg font-semibold text-gray-200"></h3>
                                                <button
                                                    class="bg-gray-500 text-white py-2 px-3 rounded-full flex items-center">
                                                    <span class="arrow-icon"><i
                                                            class="fas fa-chevron-down text-2xl font-bold"></i></span>
                                                    <!-- Downward Arrow -->
                                                </button>
                                            </div>
                                            <div id="answer4" contenteditable="true"
                                                class="hidden mt-2 text-center text-gray-300">
                                            </div>
                                        </div>

                                        <!-- FAQ Item 5 -->
                                        <div class="faq-item bg-body p-6 rounded-lg shadow-lg cursor-pointer">
                                            <div class="flex justify-between items-center"
                                                onclick="toggleAnswer('answer5', this)">
                                                <h3 id="faqItem5" contenteditable="true"
                                                    class="text-lg font-semibold text-gray-200"></h3>
                                                <button
                                                    class="bg-gray-500 text-white py-2 px-3 rounded-full flex items-center">
                                                    <span class="arrow-icon"><i
                                                            class="fas fa-chevron-down text-2xl font-bold"></i></span>
                                                    <!-- Downward Arrow -->
                                                </button>
                                            </div>
                                            <div id="answer5" contenteditable="true"
                                                class="hidden mt-2 text-center text-gray-300">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            <!-- Image Update Section -->
                            <div id="imageUpdateSection"
                                class="hidden text-center mt-5 p-4 bg-white rounded-lg shadow-lg absolute top-full left-1/2 transform -translate-x-1/2">
                                <h2 class="text-lg font-semibold mb-4">Select a new image:</h2>
                                <input type="file" id="imageUpload" accept="image/*" class="mb-4 p-2 border rounded-md">
                                <button id="updateImageBtn"
                                    class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition duration-300">Update
                                    Image</button>
                            </div>
                            <div class="py-4 pr-16 flex justify-end mt-4"> <!-- Flex container for right alignment -->
                                <button id="saveChangesBtn" class="p-2 bg-blue-500 rounded-lg text-white">Save
                                    Changes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>
    <!-- CMS content load and update --> 
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Variable to keep track of the selected image ID and section ID
            let selectedImageId = null; // To hold the ID of the currently selected image
            let selectedSectionId = null; // To hold the section ID of the currently selected image
            let isImageSelected = false; // Variable to track if an image is currently selected
            let previousImageElement = null; // Variable to track the previously selected image element

            // Fetch page content
            fetch("api/Page-Content")
                .then(response => response.json())
                .then(data => {
                    // Check if data is an array
                    if (Array.isArray(data)) {
                        // Get all section elements
                        const sections = document.querySelectorAll('section');

                        // Create a Set to hold all section IDs for easy lookup
                        const sectionIds = new Set(Array.from(sections).map(section => section.id));

                        data.forEach(item => {
                            // Check if the item's sectionId matches any of the section IDs in the document
                            if (sectionIds.has(item.sectionId)) {
                                const element = document.getElementById(item.tagId);
                                if (element) {
                                    element.innerHTML = item.tagContent; // Update the element's content
                                } else {
                                    console.error("Element with id:", item.tagId, "not found.");
                                }
                            } else {
                                console.warn("Section ID does not match any known section:", item.sectionId);
                            }
                        });
                    } else {
                        console.error("Unexpected data format:", data);
                    }
                })
                .catch(error => {
                    console.error("Error fetching content:", error);
                });

            // Fetching image content and setting up the image selection functionality
            fetch("api/Image-Content")
                .then(response => response.json())
                .then(data => {
                    if (data && typeof data === 'object') {
                        const imageData = Array.isArray(data) ? data : [data];
                        const sections = document.querySelectorAll('section');
                        const sectionIds = new Set(Array.from(sections).map(section => section.id));

                        imageData.forEach(item => {
                            if (sectionIds.has(item.sectionId)) {
                                const element = document.getElementById(item.imageId);
                                if (element) {
                                    element.src = item.src;

                                    // Image selection functionality
                                    element.addEventListener("click", () => {
                                        // Check if the clicked image is the currently selected image
                                        if (selectedImageId === item.imageId) {
                                            // Unselecting the image
                                            console.log("Image unselected.");
                                            element.style.border = "2px solid transparent"; // Reset border
                                            document.getElementById("imageUpdateSection").classList.add("hidden"); // Hide update section
                                            selectedImageId = null; // Reset selected image ID
                                            selectedSectionId = null; // Reset selected section ID
                                            isImageSelected = false; // Reset selection flag
                                            previousImageElement = null; // Reset previous image element
                                        } else {
                                            // If a different image is selected
                                            if (isImageSelected && previousImageElement) {
                                                // Reset border of the previously selected image
                                                previousImageElement.style.border = "2px solid transparent"; // Reset previous image border
                                            }

                                            // Store selected image ID and section ID
                                            selectedImageId = item.imageId;
                                            selectedSectionId = item.sectionId;
                                            console.log("Image selected:", element.src);
                                            element.style.border = "2px solid blue"; // Highlight border

                                            // Get the position of the selected image
                                            const rect = element.getBoundingClientRect();
                                            const updateSection = document.getElementById("imageUpdateSection");

                                            // Set the position of the update section
                                            updateSection.style.top = `${rect.bottom + window.scrollY}px`;
                                            updateSection.style.left = `${rect.left + window.scrollX}px`;
                                            updateSection.classList.remove("hidden"); // Show update section
                                            document.getElementById("imageUpload").value = ""; // Reset the input

                                            // Update tracking variables
                                            isImageSelected = true;
                                            previousImageElement = element; // Set current element as previous
                                        }
                                    });
                                } else {
                                    console.error("Element with id:", item.imageId, "not found.");
                                }
                            } else {
                                console.warn("Section ID does not match any known section:", item.sectionId);
                            }
                        });
                    } else {
                        console.error("Unexpected data format: expected an object or array, but received:", data);
                    }
                })
                .catch(error => {
                    console.error("Error fetching content:", error);
                });

            // Update image functionality
            document.getElementById("updateImageBtn").addEventListener("click", () => {
                const fileInput = document.getElementById("imageUpload");
                const file = fileInput.files[0];

                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const imgData = e.target.result; // Get the image data
                        const imgElement = document.getElementById(selectedImageId); // Get the selected image element
                        if (imgElement) {
                            imgElement.src = imgData; // Update the image source
                            // Reset styles and hide update section
                            imgElement.style.border = "2px solid transparent"; // Reset border after update
                            document.getElementById("imageUpdateSection").classList.add("hidden"); // Hide update section

                            console.log("Image updated successfully.");
                        } else {
                            console.error("No selected image to update.");
                        }
                    };
                    reader.readAsDataURL(file); // Read the image file
                } else {
                    alert("Please select an image to upload.");
                }
            });

            // Save changes functionality
            document.getElementById("saveChangesBtn").addEventListener("click", () => {
                // Collect content from all contenteditable elements
                const contentUpdates = [];
                const contentEditableElements = document.querySelectorAll('[contenteditable="true"]');

                contentEditableElements.forEach(element => {
                    const sectionId = element.closest('section').id; // Get section ID by finding the closest section parent
                    const tagId = element.id; // Get tag ID
                    const tagContent = element.innerHTML; // Get the HTML content

                    // Ensure sectionId, tagId, and tagContent are defined
                    if (sectionId && tagId && tagContent) {
                        contentUpdates.push({
                            sectionId: sectionId, // Include the section ID
                            tagId: tagId,
                            tagContent: tagContent
                        });
                    } else {
                        console.warn("Missing data for element:", element);
                    }
                });

                // Check if there are any updates to send
                if (contentUpdates.length > 0) {
                    // Send the content updates to the server
                    fetch("api/Save-Content", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify(contentUpdates), // Convert to JSON string
                    })
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Network response was not ok');
                            }
                            return response.json();
                        })
                        .then(data => {
                            console.log("Content saved successfully:", data);
                            // Optionally: alert user or update UI to indicate success
                        })
                        .catch(error => {
                            console.error("Error saving content:", error);
                        });
                } else {
                    console.warn("No content updates to save.");
                }

                // Handle image upload if an image is selected
                const fileInput = document.getElementById("imageUpload");
                const file = fileInput.files[0];

                if (file) {
                    const formData = new FormData(); // Create a FormData object
                    formData.append("imageUpload", file); // Append the file to the form data
                    formData.append("sectionId", selectedSectionId); // Append section ID
                    formData.append("imageId", selectedImageId); // Append image ID

                    fetch("/api/Save-Image", {
                        method: "POST",
                        body: formData, // Use the form data as the body
                    })
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Network response was not ok');
                            }
                            return response.json();
                        })
                        .then(data => {
                            console.log("Image saved successfully:", data);
                            // Optionally: alert user or update UI to indicate success
                        })
                        .catch(error => {
                            console.error("Error saving image:", error);
                        });
                } else {
                    console.error("No file selected.");
                }
            });
        });
    </script>
    <!-- Logout -->
    <script>
        document.getElementById('logout-button').addEventListener('click', function () {
            // Use the server-side logout endpoint to clear the session
            fetch('/admin-logout', { // Updated to match the server endpoint
                method: 'POST',
                credentials: 'include', // Include credentials to allow sending cookies
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    // Clear any token from local storage
                    localStorage.removeItem('token');
                    // Clear any session-related data from cookies
                    document.cookie = 'session=; Max-Age=0; path=/';
                    // Redirect to the login page
                    window.location.href = '/admin-login';
                } else {
                    alert('Error logging out');
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    </script>
    <!-- Function to check if the admin is already logged in  -->
    <script>
        function checkAdminSession() {
            fetch('/api/check-session', {
                method: 'GET',
                credentials: 'include' // Include cookies to check the session
            })
            .then(response => response.json())
            .then(data => {
                if (!data.isAuthenticated) {
                    // If the session is not valid, redirect to the admin login page
                    window.location.href = '/admin-login';
                }
                // If authenticated, no redirection needed; the user stays on the current page
            })
            .catch(error => {
                console.error('Error checking session:', error);
            });
        }
    
        // Check the session on page load
        document.addEventListener('DOMContentLoaded', checkAdminSession);
    </script>
</body>
</html>